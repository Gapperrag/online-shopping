# åœ¨çº¿è´­ç‰©å¹³å° - äº‘æœåŠ¡å™¨éƒ¨ç½²æŒ‡å—

## ğŸ“‹ ç›®å½•
1. [äº‘æœåŠ¡é€‰æ‹©](#äº‘æœåŠ¡é€‰æ‹©)
2. [æœåŠ¡å™¨è´­ä¹°ä¸é…ç½®](#æœåŠ¡å™¨è´­ä¹°ä¸é…ç½®)
3. [ç¯å¢ƒå®‰è£…](#ç¯å¢ƒå®‰è£…)
4. [é¡¹ç›®éƒ¨ç½²](#é¡¹ç›®éƒ¨ç½²)
5. [æ•°æ®åº“é…ç½®](#æ•°æ®åº“é…ç½®)
6. [è¿›ç¨‹ç®¡ç†ä¸è‡ªå¯](#è¿›ç¨‹ç®¡ç†ä¸è‡ªå¯)
7. [åå‘ä»£ç†é…ç½®](#åå‘ä»£ç†é…ç½®)
8. [é˜²ç«å¢™ä¸å®‰å…¨](#é˜²ç«å¢™ä¸å®‰å…¨)
9. [ç›‘æ§ä¸ç»´æŠ¤](#ç›‘æ§ä¸ç»´æŠ¤)
10. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)
11. [å®éªŒæŠ¥å‘Šä¿¡æ¯](#å®éªŒæŠ¥å‘Šä¿¡æ¯)

---

## äº‘æœåŠ¡é€‰æ‹©

### æ¨èæ–¹æ¡ˆï¼šé˜¿é‡Œäº‘è½»é‡åº”ç”¨æœåŠ¡å™¨

| æŒ‡æ ‡ | é…ç½® | ä»·æ ¼ |
|------|------|------|
| CPU | 2æ ¸ | - |
| å†…å­˜ | 2GB | - |
| å¸¦å®½ | 3Mbps | - |
| æœˆä»· | çº¦30å…ƒ | å­¦ç”Ÿä»·/æ–°ç”¨æˆ·ä¼˜æƒ  |
| æ“ä½œç³»ç»Ÿ | Ubuntu 20.04/22.04 LTS | - |

**ä¼˜åŠ¿**ï¼š
- âœ… ä¸­æ–‡æ”¯æŒï¼Œå­¦ç”Ÿä¼˜æƒ ï¼ˆéœ€è®¤è¯ï¼‰
- âœ… ä¸€é”®éƒ¨ç½²æ¨¡æ¿
- âœ… é˜²ç«å¢™å’Œå®‰å…¨ç»„ç®¡ç†ç®€å•
- âœ… æµé‡å……è¶³ï¼ˆ3Mbpså¸¦å®½è¶³ä»¥æ”¯æ’‘å°å‹åº”ç”¨ï¼‰

### å…¶ä»–æ–¹æ¡ˆ

| äº‘æœåŠ¡å•† | äº§å“ | ç‰¹ç‚¹ | ä»·æ ¼ |
|---------|------|------|------|
| AWS | EC2 t3.micro | å…è´¹å±‚ï¼ˆ1å¹´ï¼‰ | $0/æœˆï¼ˆé¦–å¹´ï¼‰ |
| è…¾è®¯äº‘ | äº‘æœåŠ¡å™¨CVM | æ–°ç”¨æˆ·ä¼˜æƒ  | Â¥99/å¹´èµ· |
| åä¸ºäº‘ | ECS | å­¦ç”Ÿä¼˜æƒ  | Â¥60/å¹´ |

---

## æœåŠ¡å™¨è´­ä¹°ä¸é…ç½®

### é˜¿é‡Œäº‘è½»é‡åº”ç”¨æœåŠ¡å™¨è´­ä¹°æ­¥éª¤

1. **ç™»å½•é˜¿é‡Œäº‘æ§åˆ¶å°**
   - è®¿é—® https://www.aliyun.com/
   - æ³¨å†Œ/ç™»å½•è´¦æˆ·

2. **è´­ä¹°æœåŠ¡å™¨**
   - è¿›å…¥ "è½»é‡åº”ç”¨æœåŠ¡å™¨" äº§å“é¡µé¢
   - é€‰æ‹©é…ç½®ï¼š2æ ¸2GBå†…å­˜ï¼Œ3Mbpså¸¦å®½
   - é€‰æ‹©é•œåƒï¼šUbuntu 20.04 LTS æˆ– 22.04 LTS
   - é€‰æ‹©è´­ä¹°æ—¶é•¿ï¼šå»ºè®®3ä¸ªæœˆæˆ–ä»¥ä¸Šï¼ˆä¿è¯è®¿é—®æœŸé™ï¼‰
   - å®Œæˆæ”¯ä»˜

3. **è·å–æœåŠ¡å™¨ä¿¡æ¯**
   - æœåŠ¡å™¨å…¬ç½‘IPï¼šè®°å½•ä¸‹æ¥ï¼Œç”¨äºSSHè¿æ¥
   - æœåŠ¡å™¨å¯†ç æˆ–å¯†é’¥å¯¹ï¼šé‡è¦ï¼ç”¨äºç™»å½•

4. **é‡ç½®å¯†ç æˆ–é…ç½®å¯†é’¥**
   - **æ–¹æ¡ˆAï¼ˆæ¨èï¼‰**ï¼šä½¿ç”¨ç½‘é¡µç»ˆç«¯Workbench
     - æ§åˆ¶å° â†’ å®ä¾‹è¯¦æƒ… â†’ è¿œç¨‹è¿æ¥ â†’ Workbench
     - ç›´æ¥åœ¨ç½‘é¡µæµè§ˆå™¨ä¸­æ“ä½œï¼Œæ— éœ€å¯†é’¥
   
   - **æ–¹æ¡ˆB**ï¼šä½¿ç”¨SSHå¯†é’¥ç™»å½•
     - ä¸‹è½½å¯†é’¥å¯¹æ–‡ä»¶ï¼ˆ.pemæ ¼å¼ï¼‰
     - ä¿å­˜åˆ°æœ¬åœ°å®‰å…¨ä½ç½®
     - è®¾ç½®æ–‡ä»¶æƒé™ï¼š`chmod 600 your-key.pem`

   - **æ–¹æ¡ˆC**ï¼šé‡ç½®å¯†ç åç”¨å¯†ç ç™»å½•
     - æ§åˆ¶å° â†’ é‡ç½®å¯†ç 
     - é‡å¯æœåŠ¡å™¨ä½¿å¯†ç ç”Ÿæ•ˆ
     - ç„¶åä¿®æ”¹SSHé…ç½®å…è®¸å¯†ç ç™»å½•

---

## ç¯å¢ƒå®‰è£…

### æ­¥éª¤1ï¼šç³»ç»Ÿæ›´æ–°

```bash
# ä»¥rootç”¨æˆ·æ‰§è¡Œä»¥ä¸‹å‘½ä»¤
sudo apt update
sudo apt upgrade -y
```

### æ­¥éª¤2ï¼šå®‰è£…Node.js 18.x

```bash
# æ·»åŠ NodeSourceä»“åº“
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -

# å®‰è£…Node.js
sudo apt install -y nodejs

# éªŒè¯å®‰è£…
node -v      # åº”æ˜¾ç¤º v18.x.x
npm -v       # åº”æ˜¾ç¤º 9.x.xæˆ–ä»¥ä¸Š
```

### æ­¥éª¤3ï¼šå®‰è£…MySQL 8.0

```bash
# å®‰è£…MySQLæœåŠ¡å™¨
sudo apt install -y mysql-server

# å¯åŠ¨MySQLæœåŠ¡
sudo systemctl start mysql
sudo systemctl enable mysql  # è®¾ç½®å¼€æœºè‡ªå¯

# éªŒè¯MySQLè¿è¡ŒçŠ¶æ€
sudo systemctl status mysql

# ï¼ˆå¯é€‰ï¼‰è®¾ç½®MySQL rootå¯†ç 
sudo mysql -u root -e "ALTER USER 'root'@'localhost' IDENTIFIED BY 'your_password';"
```

### æ­¥éª¤4ï¼šå®‰è£…Git

```bash
sudo apt install -y git
git --version  # éªŒè¯
```

### æ­¥éª¤5ï¼šå®‰è£…PM2ï¼ˆè¿›ç¨‹ç®¡ç†å™¨ï¼‰

```bash
sudo npm install -g pm2

# éªŒè¯
pm2 -v

# è®¾ç½®å¼€æœºè‡ªå¯
sudo pm2 startup
sudo pm2 save
```

### æ­¥éª¤6ï¼šå®‰è£…Nginxï¼ˆåå‘ä»£ç†ï¼‰

```bash
sudo apt install -y nginx

# å¯åŠ¨Nginx
sudo systemctl start nginx
sudo systemctl enable nginx  # å¼€æœºè‡ªå¯

# éªŒè¯
sudo systemctl status nginx
```

---

## é¡¹ç›®éƒ¨ç½²

### æ­¥éª¤1ï¼šå…‹éš†é¡¹ç›®ä»£ç 

```bash
# è¿›å…¥/homeç›®å½•ï¼ˆæˆ–å…¶ä»–åˆé€‚ä½ç½®ï¼‰
cd /home

# å…‹éš†é¡¹ç›®ï¼ˆå¦‚æœæ‰˜ç®¡åœ¨GitHubï¼‰
git clone https://github.com/your-username/online-shopping.git

# å¦‚æœæ²¡æœ‰GitHubï¼Œä½¿ç”¨æœ¬åœ°ä¸Šä¼ 
# åœ¨æœ¬åœ°è¿è¡Œï¼šscp -r ./online-shopping root@your-server-ip:/home/

cd online-shopping
```

### æ­¥éª¤2ï¼šå®‰è£…ä¾èµ–

```bash
npm install
```

### æ­¥éª¤3ï¼šé…ç½®ç¯å¢ƒå˜é‡

```bash
# åˆ›å»º.envæ–‡ä»¶
nano .env
```

**è¾“å…¥ä»¥ä¸‹å†…å®¹**ï¼ˆæ ¹æ®å®é™…æƒ…å†µä¿®æ”¹ï¼‰ï¼š

```env
# æ•°æ®åº“é…ç½®
DB_HOST=localhost
DB_USER=root
DB_PASSWORD=your_mysql_root_password
DB_NAME=shopping_db

# JWTå¯†é’¥
JWT_SECRET=your_super_secret_jwt_key_change_this

# é‚®ä»¶é…ç½®ï¼ˆå¯é€‰ï¼Œç”¨äºè®¢å•ç¡®è®¤é‚®ä»¶ï¼‰
EMAIL_USER=your_gmail@gmail.com
EMAIL_PASSWORD=your_gmail_app_password

# æœåŠ¡å™¨ç«¯å£
PORT=3000

# ç¯å¢ƒ
NODE_ENV=production
```

**ä¿å­˜æ–‡ä»¶**ï¼šæŒ‰ `Ctrl+O` â†’ æŒ‰å›è½¦ â†’ æŒ‰ `Ctrl+X` é€€å‡ºnanoç¼–è¾‘å™¨

### æ­¥éª¤4ï¼šåˆå§‹åŒ–æ•°æ®åº“

```bash
# åˆå§‹åŒ–è¡¨ç»“æ„å¹¶å¯¼å…¥ç¤ºä¾‹æ•°æ®
npm run setup

# æˆ–åˆ†æ­¥æ‰§è¡Œ
# npm run init-db    # åˆ›å»ºè¡¨
# npm run seed       # å¯¼å…¥ç¤ºä¾‹æ•°æ®
```

### æ­¥éª¤5ï¼šéªŒè¯æœ¬åœ°è¿è¡Œ

```bash
# å¯åŠ¨åº”ç”¨ï¼ˆæµ‹è¯•ç”¨ï¼‰
npm run start

# åº”æ˜¾ç¤ºï¼šServer is running on http://localhost:3000
# æŒ‰Ctrl+Cåœæ­¢

# æˆ–ä½¿ç”¨å¼€å‘æ¨¡å¼ï¼ˆè‡ªåŠ¨é‡å¯ï¼‰
npm run dev
```

---

## æ•°æ®åº“é…ç½®

### åˆ›å»ºæ•°æ®åº“ç”¨æˆ·ï¼ˆå¯é€‰ï¼Œæ›´å®‰å…¨ï¼‰

```bash
# ç™»å½•MySQL
sudo mysql -u root -p

# åœ¨MySQLå‘½ä»¤è¡Œä¸­æ‰§è¡Œ
CREATE DATABASE shopping_db;
CREATE USER 'shopping_user'@'localhost' IDENTIFIED BY 'secure_password_here';
GRANT ALL PRIVILEGES ON shopping_db.* TO 'shopping_user'@'localhost';
FLUSH PRIVILEGES;
EXIT;
```

ç„¶ååœ¨.envä¸­ä¿®æ”¹ï¼š
```env
DB_USER=shopping_user
DB_PASSWORD=secure_password_here
```

### æ•°æ®åº“å¤‡ä»½

```bash
# æ¯æ—¥è‡ªåŠ¨å¤‡ä»½è„šæœ¬
cat > /home/online-shopping/backup-db.sh << 'EOF'
#!/bin/bash
BACKUP_DIR="/home/online-shopping/backups"
mkdir -p $BACKUP_DIR
TIMESTAMP=$(date +%Y%m%d_%H%M%S)
mysqldump -u root -p$DB_PASSWORD shopping_db > $BACKUP_DIR/shopping_db_$TIMESTAMP.sql
# åˆ é™¤30å¤©å‰çš„å¤‡ä»½
find $BACKUP_DIR -name "*.sql" -mtime +30 -delete
EOF

chmod +x /home/online-shopping/backup-db.sh

# æ·»åŠ å®šæ—¶ä»»åŠ¡ï¼ˆæ¯å¤©å‡Œæ™¨2ç‚¹å¤‡ä»½ï¼‰
crontab -e
# æ·»åŠ è¿™ä¸€è¡Œï¼š
# 0 2 * * * /home/online-shopping/backup-db.sh
```

---

## è¿›ç¨‹ç®¡ç†ä¸è‡ªå¯

### ä½¿ç”¨PM2å¯åŠ¨åº”ç”¨

```bash
cd /home/online-shopping

# ç”¨PM2å¯åŠ¨åº”ç”¨
pm2 start src/app.js --name "shopping-app"

# æŸ¥çœ‹è¿è¡ŒçŠ¶æ€
pm2 status

# æŸ¥çœ‹æ—¥å¿—
pm2 logs shopping-app

# é‡å¯åº”ç”¨
pm2 restart shopping-app

# åœæ­¢åº”ç”¨
pm2 stop shopping-app
```

### é…ç½®PM2ç”Ÿæ€ç³»ç»Ÿæ–‡ä»¶ï¼ˆæ¨èï¼‰

```bash
# åˆ›å»ºecosystem.config.js
cat > /home/online-shopping/ecosystem.config.js << 'EOF'
module.exports = {
  apps: [{
    name: 'shopping-app',
    script: './src/app.js',
    instances: 1,
    exec_mode: 'cluster',
    watch: false,
    max_memory_restart: '500M',
    env: {
      NODE_ENV: 'production'
    },
    error_file: './logs/err.log',
    out_file: './logs/out.log',
    log_date_format: 'YYYY-MM-DD HH:mm:ss Z',
    merge_logs: true
  }]
};
EOF

# ä½¿ç”¨ç”Ÿæ€æ–‡ä»¶å¯åŠ¨
pm2 start ecosystem.config.js

# è®¾ç½®å¼€æœºè‡ªå¯
sudo pm2 startup
sudo pm2 save
```

### æŸ¥çœ‹åº”ç”¨æ—¥å¿—

```bash
# å®æ—¶æŸ¥çœ‹æ—¥å¿—
pm2 logs shopping-app

# æˆ–æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶
tail -f /home/online-shopping/logs/out.log
tail -f /home/online-shopping/logs/err.log
```

---

## åå‘ä»£ç†é…ç½®

### é…ç½®Nginx

```bash
# åˆ›å»ºNginxé…ç½®æ–‡ä»¶
sudo nano /etc/nginx/sites-available/shopping-app
```

**è¾“å…¥ä»¥ä¸‹å†…å®¹**ï¼š

```nginx
upstream shopping_backend {
    server 127.0.0.1:3000;
    keepalive 64;
}

server {
    listen 80;
    server_name your-domain.com www.your-domain.com 172.24.189.3;  # æ›¿æ¢ä¸ºä½ çš„åŸŸåæˆ–IP

    # é‡å®šå‘HTTPåˆ°HTTPSï¼ˆå¯é€‰ï¼Œéœ€è¦SSLè¯ä¹¦ï¼‰
    # return 301 https://$server_name$request_uri;

    location / {
        proxy_pass http://shopping_backend;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
        
        # è¶…æ—¶è®¾ç½®
        proxy_connect_timeout 60s;
        proxy_send_timeout 60s;
        proxy_read_timeout 60s;
    }

    # é™æ€æ–‡ä»¶ç¼“å­˜ï¼ˆå¯é€‰ä¼˜åŒ–ï¼‰
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2)$ {
        proxy_pass http://shopping_backend;
        proxy_cache_valid 200 30d;
        add_header Cache-Control "public, immutable";
    }

    # å¥åº·æ£€æŸ¥
    location /health {
        access_log off;
        return 200 "healthy\n";
        add_header Content-Type text/plain;
    }
}
```

**ä¿å­˜å¹¶å¯ç”¨é…ç½®**ï¼š

```bash
# æ£€æŸ¥è¯­æ³•
sudo nginx -t

# åˆ›å»ºç¬¦å·é“¾æ¥å¯ç”¨ç«™ç‚¹
sudo ln -s /etc/nginx/sites-available/shopping-app /etc/nginx/sites-enabled/

# ç§»é™¤é»˜è®¤ç«™ç‚¹ï¼ˆå¦‚æœéœ€è¦ï¼‰
sudo rm /etc/nginx/sites-enabled/default

# é‡æ–°åŠ è½½Nginx
sudo systemctl reload nginx

# éªŒè¯
sudo systemctl status nginx
```

---

## é˜²ç«å¢™ä¸å®‰å…¨

### é…ç½®UFWé˜²ç«å¢™

```bash
# å¯ç”¨é˜²ç«å¢™
sudo ufw enable

# å…è®¸SSHï¼ˆå¿…é¡»ï¼å¦åˆ™æ— æ³•è¿œç¨‹è¿æ¥ï¼‰
sudo ufw allow 22

# å…è®¸HTTP
sudo ufw allow 80

# å…è®¸HTTPS
sudo ufw allow 443

# æŸ¥çœ‹è§„åˆ™
sudo ufw status

# å¦‚æœéœ€è¦ç‰¹å®šIPè®¿é—®
# sudo ufw allow from 192.168.1.100 to any port 22
```

### å®‰å…¨åŠ å›º

```bash
# 1. æ›´æ–°ç³»ç»Ÿè¡¥ä¸ï¼ˆå®šæœŸæ‰§è¡Œï¼‰
sudo apt update && sudo apt upgrade -y

# 2. å®‰è£…Fail2Banï¼ˆé˜²æ­¢æš´åŠ›ç ´è§£ï¼‰
sudo apt install -y fail2ban
sudo systemctl enable fail2ban
sudo systemctl start fail2ban

# 3. é…ç½®SSHåªå…è®¸å¯†é’¥ç™»å½•ï¼ˆå¯é€‰ï¼‰
sudo nano /etc/ssh/sshd_config
# æ‰¾åˆ°ä»¥ä¸‹è¡Œå¹¶ä¿®æ”¹ï¼š
# PermitRootLogin no
# PasswordAuthentication no
# PubkeyAuthentication yes

# 4. é‡å¯SSHæœåŠ¡
sudo systemctl restart sshd
```

---

## ç›‘æ§ä¸ç»´æŠ¤

### åº”ç”¨ç›‘æ§

```bash
# æŸ¥çœ‹åº”ç”¨å®æ—¶çŠ¶æ€
pm2 monit

# æˆ–ä½¿ç”¨PM2 Webç›‘æ§é¢æ¿
pm2 web
# è®¿é—® http://your-ip:9615
```

### å®šæœŸæ£€æŸ¥æœåŠ¡

```bash
# æŸ¥çœ‹åº”ç”¨çŠ¶æ€
pm2 status

# æŸ¥çœ‹ç³»ç»Ÿèµ„æºä½¿ç”¨
free -h          # å†…å­˜
df -h             # ç£ç›˜
top              # å®æ—¶è¿›ç¨‹

# æŸ¥çœ‹NginxçŠ¶æ€
sudo systemctl status nginx

# æŸ¥çœ‹MySQLçŠ¶æ€
sudo systemctl status mysql
```

### æ—¥å¿—è½®è½¬ï¼ˆé˜²æ­¢æ—¥å¿—æ–‡ä»¶è¿‡å¤§ï¼‰

```bash
# åˆ›å»ºlogrotateé…ç½®
sudo nano /etc/logrotate.d/shopping-app
```

**è¾“å…¥ä»¥ä¸‹å†…å®¹**ï¼š

```
/home/online-shopping/logs/*.log {
    daily
    rotate 7
    compress
    delaycompress
    notifempty
    create 0640 nobody nobody
    sharedscripts
    postrotate
        pm2 restart shopping-app > /dev/null 2>&1 || true
    endscript
}
```

---

## å¸¸è§é—®é¢˜

### Q1: å¦‚ä½•é‡å¯åº”ç”¨ï¼Ÿ

```bash
pm2 restart shopping-app
# æˆ–é‡æ–°åŠ è½½ï¼ˆä¸ä¸­æ–­æœåŠ¡ï¼‰
pm2 reload shopping-app
```

### Q2: åº”ç”¨å¯åŠ¨å¤±è´¥ï¼Œå¦‚ä½•æ’æŸ¥ï¼Ÿ

```bash
# æŸ¥çœ‹è¯¦ç»†é”™è¯¯æ—¥å¿—
pm2 logs shopping-app --err

# æ£€æŸ¥.envæ–‡ä»¶
cat /home/online-shopping/.env

# æ£€æŸ¥æ•°æ®åº“è¿æ¥
sudo mysql -u root -p

# æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨
sudo netstat -tlnp | grep 3000
```

### Q3: æ•°æ®åº“è¿æ¥é”™è¯¯"access denied"

```bash
# æ£€æŸ¥MySQLç”¨æˆ·å’Œå¯†ç 
sudo mysql -u root -p shopping_db

# é‡ç½®rootå¯†ç 
sudo mysql -u root -e "ALTER USER 'root'@'localhost' IDENTIFIED BY 'newpassword';"

# æ›´æ–°.envæ–‡ä»¶çš„DB_PASSWORD
```

### Q4: Nginxæ˜¾ç¤º502 Bad Gateway

```bash
# æ£€æŸ¥Node.jsåº”ç”¨æ˜¯å¦è¿è¡Œ
pm2 status

# æ£€æŸ¥Nginxé…ç½®
sudo nginx -t

# æŸ¥çœ‹Nginxé”™è¯¯æ—¥å¿—
sudo tail -f /var/log/nginx/error.log

# æ£€æŸ¥3000ç«¯å£æ˜¯å¦ç›‘å¬
sudo netstat -tlnp | grep 3000
```

### Q5: å¦‚ä½•HTTPSè®¿é—®ï¼ˆSSLè¯ä¹¦ï¼‰ï¼Ÿ

```bash
# å®‰è£…Certbotï¼ˆLet's Encryptå…è´¹è¯ä¹¦ï¼‰
sudo apt install -y certbot python3-certbot-nginx

# è·å–è¯ä¹¦ï¼ˆéœ€è¦çœŸå®åŸŸåï¼‰
sudo certbot certonly --nginx -d your-domain.com -d www.your-domain.com

# è‡ªåŠ¨é…ç½®Nginx
sudo certbot --nginx -d your-domain.com

# è®¾ç½®è‡ªåŠ¨ç»­æœŸ
sudo systemctl enable certbot.timer
```

### Q6: è®¿é—®é€Ÿåº¦æ…¢

```bash
# 1. å¢åŠ PM2å®ä¾‹æ•°
pm2 delete shopping-app
pm2 start src/app.js --name "shopping-app" -i max  # ä½¿ç”¨æ‰€æœ‰CPUæ ¸å¿ƒ

# 2. å¯ç”¨Nginxç¼“å­˜å’Œå‹ç¼©
# åœ¨nginxé…ç½®ä¸­æ·»åŠ ï¼š
gzip on;
gzip_comp_level 6;
gzip_types text/plain text/css text/xml text/javascript application/json application/javascript;

# 3. ä¼˜åŒ–MySQLæŸ¥è¯¢ï¼ˆæ·»åŠ ç´¢å¼•ï¼‰
```

---

## å®éªŒæŠ¥å‘Šä¿¡æ¯

### ğŸ“Œ éƒ¨ç½²å®Œæˆæ¸…å•

éƒ¨ç½²æˆåŠŸåï¼Œè¯·åœ¨å®éªŒæŠ¥å‘Šä¸­å¡«å†™ä»¥ä¸‹ä¿¡æ¯ï¼š

#### 1. **è®¿é—®åœ°å€**
```
å®Œæ•´URL: http://172.24.189.3/
æˆ–: http://your-domain.com/
```

#### 2. **æµ‹è¯•è´¦æˆ·ä¿¡æ¯**

| è´¦æˆ·ç±»å‹ | è´¦æˆ· | å¯†ç  | è¯´æ˜ |
|---------|------|------|------|
| ç®¡ç†å‘˜ | admin@example.com | admin123456 | å¯è®¿é—®åå°ç®¡ç† |
| æ™®é€šç”¨æˆ· | user@example.com | password123 | æ™®é€šè´­ç‰©ç”¨æˆ· |
| æµ‹è¯•è´¦æˆ· | test@example.com | test123456 | ç”¨äºæ¼”ç¤º |

**æ–°ç”¨æˆ·æ³¨å†Œ**: åœ¨å¹³å°é¦–é¡µç‚¹å‡»"æ³¨å†Œ"è‡ªè¡Œåˆ›å»ºè´¦æˆ·

#### 3. **ç³»ç»Ÿè®¿é—®ä¿è¯**

- âœ… **ä¿è¯æœŸé™**: 2025å¹´12æœˆ28æ—¥ ~ 2026å¹´3æœˆ28æ—¥ï¼ˆ3ä¸ªæœˆï¼‰
- âœ… **æ ¡å›­ç½‘è®¿é—®**: å·²åœ¨æ ¡å›­ç½‘å†…éƒ¨ç½²ï¼Œæ”¯æŒIPv4è®¿é—®
- âœ… **å¯ç”¨æ€§SLA**: 99%ï¼ˆå…è®¸å®šæœŸç»´æŠ¤ï¼‰
- âœ… **æŠ€æœ¯æ”¯æŒ**: å¦‚æœ‰é—®é¢˜ï¼Œè¯·è”ç³»éƒ¨ç½²äººå‘˜

#### 4. **æ ¸å¿ƒåŠŸèƒ½éªŒè¯**

**ç”¨æˆ·ç«¯åŠŸèƒ½**ï¼š
- [ ] ç”¨æˆ·æ³¨å†Œå’Œç™»å½•
- [ ] æµè§ˆå•†å“å’Œæœç´¢
- [ ] åŠ å…¥è´­ç‰©è½¦
- [ ] ç»“ç®—å’Œæ”¯ä»˜
- [ ] æŸ¥çœ‹è®¢å•å’Œè®¢å•è¯¦æƒ…
- [ ] ç¡®è®¤æ”¶è´§å’Œå–æ¶ˆè®¢å•
- [ ] æ¥æ”¶è®¢å•é‚®ä»¶é€šçŸ¥

**ç®¡ç†å‘˜åŠŸèƒ½**ï¼š
- [ ] ç®¡ç†å‘˜ç™»å½•
- [ ] å•†å“ç®¡ç†ï¼ˆå¢åˆ æ”¹æŸ¥ï¼‰
- [ ] è®¢å•ç®¡ç†ï¼ˆæŸ¥çœ‹å’Œæ›´æ–°çŠ¶æ€ï¼‰
- [ ] é”€å”®æŠ¥è¡¨æŸ¥çœ‹
- [ ] å–æ¶ˆè®¢å•è‡ªåŠ¨æ¢å¤åº“å­˜

#### 5. **æŠ€æœ¯æ ˆä¿¡æ¯**

| ç»„ä»¶ | ç‰ˆæœ¬ | è¯´æ˜ |
|------|------|------|
| Node.js | 18.x LTS | åç«¯è¿è¡Œæ—¶ |
| Express.js | 4.x | Webæ¡†æ¶ |
| MySQL | 8.0 | æ•°æ®åº“ |
| PM2 | æœ€æ–°ç‰ˆ | è¿›ç¨‹ç®¡ç† |
| Nginx | æœ€æ–°ç‰ˆ | åå‘ä»£ç† |
| Ubuntu | 20.04/22.04 | æ“ä½œç³»ç»Ÿ |

#### 6. **éƒ¨ç½²æ¶æ„**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ç”¨æˆ·æµè§ˆå™¨ (æ ¡å›­ç½‘)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚ HTTP:80
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Nginx åå‘ä»£ç† (ç«¯å£80)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚ åå‘ä»£ç†
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Node.js + Express (ç«¯å£3000)          â”‚
â”‚   â”œâ”€ ç”¨æˆ·è®¤è¯ä¸æˆæƒ                    â”‚
â”‚   â”œâ”€ äº§å“ç®¡ç†API                        â”‚
â”‚   â”œâ”€ è´­ç‰©è½¦ä¸è®¢å•                       â”‚
â”‚   â”œâ”€ è®¢å•æ”¯ä»˜ä¸ç¡®è®¤                     â”‚
â”‚   â””â”€ è®¢å•çŠ¶æ€ç®¡ç†                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚ SQLæŸ¥è¯¢
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    MySQL æ•°æ®åº“ (shopping_db)           â”‚
â”‚    â”œâ”€ users (ç”¨æˆ·è¡¨)                    â”‚
â”‚    â”œâ”€ products (å•†å“è¡¨)                 â”‚
â”‚    â”œâ”€ shopping_cart (è´­ç‰©è½¦è¡¨)         â”‚
â”‚    â”œâ”€ orders (è®¢å•è¡¨)                   â”‚
â”‚    â””â”€ order_items (è®¢å•é¡¹ç›®è¡¨)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 7. **éƒ¨ç½²å‘½ä»¤é€ŸæŸ¥è¡¨**

```bash
# åº”ç”¨ç®¡ç†
pm2 start src/app.js --name "shopping-app"
pm2 restart shopping-app
pm2 stop shopping-app
pm2 logs shopping-app

# æ•°æ®åº“
npm run setup                    # åˆå§‹åŒ–æ•°æ®åº“
npm run clean-db               # æ¸…ç©ºæ•°æ®åº“ï¼ˆè°¨æ…ï¼ï¼‰

# Nginx
sudo systemctl start nginx
sudo systemctl restart nginx
sudo nginx -t                  # æµ‹è¯•é…ç½®

# ç›‘æ§
pm2 status
pm2 monit
free -h
df -h
```

#### 8. **è”ç³»ä¿¡æ¯**

- **éƒ¨ç½²äººå‘˜**: [ä½ çš„å§“å]
- **éƒ¨ç½²æ—¥æœŸ**: [éƒ¨ç½²å®Œæˆæ—¥æœŸ]
- **æœåŠ¡å™¨IP**: 172.24.189.3
- **åº”æ€¥è”ç³»**: [ä½ çš„è”ç³»æ–¹å¼]

---

## ğŸ“ é—®é¢˜æ’æŸ¥ä¸æ”¯æŒ

å¦‚éƒ¨ç½²è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œè¯·æŒ‰ä»¥ä¸‹æ­¥éª¤æ’æŸ¥ï¼š

1. **æ£€æŸ¥æœåŠ¡çŠ¶æ€**
   ```bash
   pm2 status
   sudo systemctl status nginx
   sudo systemctl status mysql
   ```

2. **æŸ¥çœ‹åº”ç”¨æ—¥å¿—**
   ```bash
   pm2 logs shopping-app
   tail -f /var/log/nginx/error.log
   ```

3. **æ£€æŸ¥ç½‘ç»œè¿é€šæ€§**
   ```bash
   ping 8.8.8.8
   netstat -tlnp | grep -E ':(80|3000|3306)'
   ```

4. **é‡å¯åº”ç”¨å’ŒæœåŠ¡**
   ```bash
   pm2 restart all
   sudo systemctl restart nginx
   sudo systemctl restart mysql
   ```

---

## ğŸ“š å‚è€ƒèµ„æº

- [Express.jså®˜æ–¹æ–‡æ¡£](https://expressjs.com/)
- [MySQLæ–‡æ¡£](https://dev.mysql.com/doc/)
- [PM2æ–‡æ¡£](https://pm2.keymetrics.io/)
- [Nginxå®˜æ–¹æ–‡æ¡£](https://nginx.org/en/docs/)
- [Ubuntu ServeræŒ‡å—](https://ubuntu.com/server/docs)

---

**éƒ¨ç½²å®Œæˆï¼ç¥ä½ çš„åœ¨çº¿è´­ç‰©å¹³å°è¿è¥é¡ºåˆ©ï¼** ğŸ‰
